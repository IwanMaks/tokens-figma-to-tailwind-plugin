<!DOCTYPE html>
<html>
  <body style="font-family: sans-serif; padding: 16px">
    <h2>üé® Figma Tokens ‚Üí Tailwind</h2>
    <p>–°–æ–±–µ—Ä–∏ —Ç–æ–∫–µ–Ω—ã –∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π —Ñ–∞–π–ª—ã.</p>
    <button id="export" style="padding: 8px 16px">–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–∫–µ–Ω—ã</button>
    <div id="result" style="margin-top: 16px; white-space: pre-wrap"></div>
    <script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>
    <script>
      document.getElementById("export").onclick = () => {
        parent.postMessage({ pluginMessage: { type: "export-tokens" } }, "*");
      };
      // –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç –ø–ª–∞–≥–∏–Ω–∞
      window.onmessage = async (event) => {
        const msg = event.data.pluginMessage;
        if (!msg) return;
        if (msg.type === "export-files") {
          console.log("üì¶ –ü–æ–ª—É—á–µ–Ω—ã —Ñ–∞–π–ª—ã:", msg.files);
          await downloadZip(msg.files);
        }
      };
      // –£–ø–∞–∫–æ–≤–∫–∞ –∏ –∑–∞–≥—Ä—É–∑–∫–∞ ZIP
      async function downloadZip(files) {
        const zip = new JSZip();
        files.forEach((f) => {
          zip.file(f.name, f.content);
        });
        const blob = await zip.generateAsync({ type: "blob" });
        const link = document.createElement("a");
        link.href = URL.createObjectURL(blob);
        link.download = "tokens.zip";
        link.click();
        document.getElementById("result").textContent =
          "‚úÖ –≠–∫—Å–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à—ë–Ω!\n\n–§–∞–π–ª—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ tokens.zip";
      }
    </script>
  </body>
</html>
